var Promise,addAll,clone,commit,config,configAll,exec,moment,push;Promise=require("es6-promise").Promise,moment=require("moment"),exec=require("./exec"),addAll=function(r){var e,n;return n=r.directory,e="git add --all",exec(e,{cwd:n})},clone=function(r){var e,n,t,o;return e=r.branchName,t=r.directory,o=r.repository,n="git clone --branch "+e+" "+o+" "+t,exec(n)},commit=function(r){var e,n,t;return n=r.directory,t=r.message,e="git commit --allow-empty --message '"+t+"'",exec(e,{cwd:n})},config=function(r){var e,n,t,o;return n=r.directory,t=r.name,o=r.value,e="git config --local "+t+" '"+o+"'",exec(e,{cwd:n})},configAll=function(r){var e,n,t,o;return e=r.configs,n=r.directory,t=r.error,o=r.log,e.reduce(function(r,e){var c,i;return c=e.name,i=e.value,r.then(function(){return config({directory:n,name:c,value:i})}).then(function(r){var e,n;return n=r.stdout,e=r.stderr,o(n),t(e),null})},Promise.resolve())},push=function(r){var e,n,t,o,c;return n=r.directory,t=r.dst,o=r.repository,c=r.src,e="git push '"+o+"' "+c+":"+t,exec(e,{cwd:n})},module.exports=function(r){var e,n,t,o,c,i,u,l,s,d,a,m,f,g,h,v;return e=null!=(s=r.branchName)?s:"gh-pages",n=r.build,t=null!=(d=r.configs)?d:[],o=null!=(a=r.directory)?a:"public",i=null!=(m=r.error)?m:console.error.bind(console),u=null!=(f=r.log)?f:console.log.bind(console),l=null!=(g=r.message)?g:moment().format(),h=r.repository,c=e,v=e,clone({branchName:e,directory:o,repository:h}).then(function(r){var e,t;return t=r.stdout,e=r.stderr,u(t),i(e),n()}).then(function(){return addAll({directory:o})}).then(function(r){var e,n;return n=r.stdout,e=r.stderr,u(n),i(e)}).then(function(){return configAll({configs:t,directory:o,error:i,log:u})}).then(function(){return commit({directory:o,message:l})}).then(function(r){var e,n;return n=r.stdout,e=r.stderr,u(n),i(e)}).then(function(){return push({repository:h,src:v,dst:c})}).then(function(r){var e,n;return n=r.stdout,e=r.stderr,u(n),i(e),null})};