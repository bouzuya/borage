var MyS3,Promise,S3,fs,mime;fs=require("fs"),Promise=require("es6-promise").Promise,S3=require("aws-sdk").S3,mime=require("mime"),MyS3=function(){function e(e){var t;e.apiVersion="2006-03-01",this._verbose=null!=(t=e.verbose)?t:!1,this._client=new S3(e)}return e.prototype.listAllObjects=function(e,t){return null==t&&(t=[]),this._listObjects(e).then(function(n){return function(r){var u;return u=r.Contents,t=t.concat(u),r.IsTruncated?(e.Marker=r.NextMarker||u[u.length-1].Key,n.listAllObjects(e,t)):t}}(this))},e.prototype.putAllObjects=function(e,t){var n,r;return n=t.Bucket,r=t.verbose,e.reduce(function(e){return function(t,r){var u,o;return u=r.key,o=r.path,t.then(function(){return e._verbose&&console.log("upload "+o+" to "+n+"/"+u),e._putObject({Bucket:n,Key:u,Body:fs.readFileSync(o),ContentType:mime.lookup(o)})})}}(this),Promise.resolve())},e.prototype._listObjects=function(e){return new Promise(function(t){return function(n,r){return t._client.listObjects(e,function(e,t){return null!=e?r(e):n(t)})}}(this))},e.prototype._putObject=function(e){return new Promise(function(t){return function(n,r){return t._client.putObject(e,function(e){return null!=e?r(e):n()})}}(this))},e}(),module.exports=function(e){return new MyS3(e)};