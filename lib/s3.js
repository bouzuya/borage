var MyS3,Promise,S3,fs,mime;fs=require("fs"),Promise=require("es6-promise").Promise,S3=require("aws-sdk").S3,mime=require("mime"),MyS3=function(){function t(t){t.apiVersion="2006-03-01",this._client=new S3(t)}return t.prototype.listAllObjects=function(t,e){return null==e&&(e=[]),this._listObjects(t).then(function(n){return function(r){var u;return u=r.Contents,e=e.concat(u),r.IsTruncated?(t.Marker=r.NextMarker||u[u.length-1].Key,n.listAllObjects(t,e)):e}}(this))},t.prototype.putAllObjects=function(t,e){var n,r;return n=e.Bucket,r=e.verbose,t.reduce(function(t){return function(e,u){var i,o;return i=u.key,o=u.path,e.then(function(){return r&&console.log("upload "+o+" to "+n+"/"+i),t._putObject({Bucket:n,Key:i,Body:fs.readFileSync(o),ContentType:mime.lookup(o)})})}}(this),Promise.resolve())},t.prototype._listObjects=function(t){return new Promise(function(e){return function(n,r){return e._client.listObjects(t,function(t,e){return null!=t?r(t):n(e)})}}(this))},t.prototype._putObject=function(t){return new Promise(function(e){return function(n,r){return e._client.putObject(t,function(t){return null!=t?r(t):n()})}}(this))},t}(),module.exports=function(t){return new MyS3(t)};